{% extends 'base.html' %}
{% block title %}{{ committee.name }}{% endblock %}
{% block content %}
<div class="row">
    <div class="col-sm-8">
        <h1>
            {{ committee.name }}
            <small>{{ committee.type }} Committee</small>
        </h1>
        <p>
            {{ committee.address1 }}
            {% if committee.address2 %}
                {{ committee.address2 }}
            {% endif %}
            {% if committee.address3 %}
                {{ committee.address3 }}
            {% endif %}
            &middot;
            {{ committee.city }},
            {{ committee.state }}
            {{ committee.zipcode }}
        </p>

        <h3>Funds controlled: {% if controlled_amount %}{{ controlled_amount|format_money }}{% else %}$0{% endif %}</h3>
        <table class="table table-striped">
            <thead>
                <th>Funds report</th>
                <th>Amount</th>
            </thead>
            <tbody>
                <tr>
                    <td>{{ latest_filing.reporting_period_end.strftime('%b %d, %Y') }} quarterly report</td>
                    <td>{{ latest_filing.end_funds_available|format_money }}</td>
                </tr>
                <tr>
                    <td>Receipts after last quarterly report</td>
                    <td>{{ recent_total|format_money }}</td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td><strong>Total funds</strong></td>
                    <td><strong>{% if controlled_amount %}{{ controlled_amount|format_money }}{% else %}$0{% endif %}</strong></td>
                </tr>
            </tfoot>
        </table>

        {% if related_committees %}
                <h3>
                    Related committees
                </h3>
                <table class="table table-striped">
                    <thead>
                        <th>Name</th>
                        <th>Committee type</th>
                        <th>Funds controlled</th>
                        <th>Reason for relation</th>
                    </thead>
                    <tbody>
                        {% for committee in related_committees %}
                            <tr>
                                <td><a href="{{ url_for('views.committee', committee_id=committee.id )}}">{{ committee.name }}</a></td>
                                <td>{{ committee.type if committee.type else '' }}</td>
                                <td>{{ committee.money|format_money if committee.money else ''}}</td>
                                <td>{{ committee.reason }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>

            {% endif %}

        {% if recent_receipts %}
            <h3>
                Receipts after last quarterly report
                <small>({{ recent_total|format_money }} Total)</small>
            </h3>
            <table class="table table-striped">
                <tbody>
                    {% for receipt in recent_receipts|sort(attribute='received_datetime', reverse=True) %}
                        <tr>
                            <td>
                                {% if receipt.first_name %}
                                    {{ receipt.first_name }}
                                {% endif %}
                                {{ receipt.last_name }}
                            </td>
                            <td class='nowrap'>
                                <a href="{{ url_for('views.contribution', receipt_id=receipt.id )}}">donated <strong>{{ receipt.amount|format_money }}</strong></a>
                            </td>
                            <td class='nowrap'>
                                on {{ receipt.received_datetime.strftime('%b %d, %Y') }}
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% endif %}
    </div>
    <div class='col-sm-4'>
        <div class='well'>
            {% if committee.candidates %}
                <table class="table table-striped">
                    <thead>
                        <th>Supported candidate</th>
                        <th>Office</th>
                    </thead>
                    <tbody>
                        {% for candidate in committee.candidates %}
                            <tr>
                                <td><a href="{{ url_for('views.candidate', candidate_id=candidate.id )}}">{{ candidate.first_name }} {{ candidate.last_name }}</a></td>
                                <td>{{ candidate.office }}</td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>

            {% endif %}

            <hr />
            <table class="table table-striped">
                <thead>
                    <th>Officer</th>
                    <th>Title</th>
                </thead>
                <tbody>
                    {% for officer in current_officers %}
                        <tr>
                            <td>{{ officer.first_name }} {{ officer.last_name }}</a></td>
                            <td>{{ officer.title }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>


{% endblock %}
