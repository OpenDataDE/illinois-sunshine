{% extends 'base.html' %}
{% block title %}Keep an eye on money in Illinois politics{% endblock %}
{% block content %}
<div class='jumbotron'>
    <p>Since 1994, <strong>${{ totals[0][0]|format_large_number }}</strong> has been donated to political campaigns in the State of Illinois. <br />Search and browse the donations and the committees that receive them.</p>

    <form action='/search' method='GET'>
        <div class="input-group input-group-lg">
            <input type="text" class="form-control" placeholder="Search for candidates, committees and donations and expenditures in Illinois" name="term">
            <input type='hidden' name='table_name' value='candidates' />
            <input type='hidden' name='table_name' value='committees' />
            <input type='hidden' name='table_name' value='officers' />
            <input type='hidden' name='table_name' value='receipts' />
            <input type='hidden' name='table_name' value='expenditures' />
            <span class="input-group-btn">
                <button class="btn btn-default" type="submit"><i class='fa fa-search'></i> Search</button>
            </span>
        </div>
    </form>
</div>

<h3>
    <i class='fa fa-dollar fa-fw'></i>
    <a href='{{ url_for('views.donations') }}'>Donations</a> <small>since 1994</small>
</h3>

<div id='donation-chart'></div>
<br />

<p><a class='btn btn-primary' href='{{ url_for('views.donations') }}'><i class='fa fa-dollar fa-fw'></i> Browse all donations &raquo;</a></p>

<h3>
    <i class='fa fa-plus-circle fa-fw'></i>
    <a href='{{ url_for('views.top_earners') }}'>Top earners</a> <small>last 30 days</small>
</h3>
<table class="table table-striped">
    <thead>
        <tr>
            <th>Rank</th>
            <th>Committee</th>
            <th>Type</th>
            <th class='text-right'>New funds</th>
            <th class='text-right'>Current funds</th>
        </tr>
    </thead>
    <tbody>
        {% for earner in top_earners %}
            <tr>
                <td>{{ loop.index }}</td>
                <td><a href="{{ url_for('views.committee', committee_id=earner.committee_id ) }}">{{ earner.name }}</a></td>
                <td>{{ earner.type }}</td>
                <td class='money-add text-right'>
                    {% if earner.amount %}
                        +{{earner.amount|format_money}}
                    {% else %}
                        $0
                    {% endif %}
                </td>
                <td class='text-right'>{{ earner.total|format_money }}</td>
            </tr>
        {% endfor %}
    </tbody>
</table>

<p>
    <a class='btn btn-primary' href='{{ url_for('views.top_earners') }}'><i class='fa fa-plus-circle fa-fw'></i> More top earners &raquo;</a>
</p>
<br /><br />

<h3><i class='fa fa-group fa-fw'></i> <a href='{{ url_for('views.committees') }}'>Committees</a> <small>highest current funds</small></h3>
<table class="table table-hover">
    <thead>
        <tr>
            <th>Rank</th>
            <th>Committee</th>
            <th>Type</th>
            <th class='text-right'>Current funds</th>
        </tr>
    </thead>
    <tbody>
        {% for record in top_ten %}
            <tr>
                <td>{{ loop.index }}</td>
                <td><a href="{{ url_for('views.committee', committee_id=record.committee_id ) }}">{{ record.committee_name }}</a></td>
                <td>{{ record.committee_type }}</td>
                <td class='text-right'>{{ record.total|format_money }}</td>
            </tr>
        {% endfor %}
    </tbody>
</table>

<p><a class='btn btn-primary' href='{{ url_for('views.committees') }}'><i class='fa fa-group fa-fw'></i> All committees &raquo;</a></p>
<br /><br />

<h3><i class='fa fa-info-circle fa-fw'></i> <a href='{{ url_for('views.about') }}'>About</a></h3>

<p><strong>Illinois Sunshine</strong> is a tool for browsing political contributions in the state of Illinois.</p>

<p>The data comes from the Illinois State Board of Elections, which has been collecting this data electronically since 1994. We built Illinois Sunshine to give journalists, activists and citizens better access to and documentation for this data.</p>

<p><a class='btn btn-primary' href='{{ url_for('views.about') }}'><i class='fa fa-info-circle fa-fw'></i> Read more &raquo;</a></p>
<br /><br />

{% endblock %}

{% block extra_javascript %}
    <script src="http://code.highcharts.com/highcharts.js"></script>
    <script src="/static/js/moment.min.js"></script>
    <script src="/static/js/chart_helper.js"></script>
    <script>

        var money = {{ donations_by_week|tojson|safe }};
        var money_f = [];
        for (i = 0; i < money.length; i++) {
            money_f.push([Date.UTC(money[i][1],money[i][2]-1,money[i][3]), money[i][0]]);
        }

        ChartHelper.donations('donation-chart', 'Campaign donations', '', 'Donations', money_f);
    </script>

{% endblock %}
